import json
from packet import Packet
import re

with open("protocol.json", "r") as f:
    PROTOCOL = json.loads(f.read())

def find_dict_by_protocol_id(id):
  for d in PROTOCOL:
    if d.get('protocol_id') == id:
      return d
  return None 


def find_protocol_id_by_name(name):
    for d in PROTOCOL:
        if d.get('name') == name:
            id = d.get("protocol_id")
            return id
    return None    


class Message():
    
    def __init__(self, packet):
        self.variables = dict()
        self.infos = dict()
        self.tasks = list()
        self.packet = packet
        
    def serialize(self, protocol_id):
        pass
    
    def read(self, task):
        var = dict()
        
        if task.get('type_id'):
            protocol_id = self.packet.readShort()
            sub_message = Message(self.packet)
            sub_message.deserialize(protocol_id)
            var[task.get('variable')] = sub_message.variables
            
        elif task.get('object'):
            protocol_id = find_protocol_id_by_name(task.get('object'))
            sub_message = Message(self.packet)
            sub_message.deserialize(protocol_id)
            var[task.get('object')] = sub_message.variables 
        
        elif task.get('parent'):
            protocol_id = find_protocol_id_by_name(task.get('parent'))
            sub_message = Message(self.packet)
            sub_message.deserialize(protocol_id)
            var[task.get('parent')] = sub_message.variables             
        
        elif task.get('type') == "VarInt":
            var[task.get('variable')] = self.packet.readVarInt()
        elif task.get('type') == "VarShort":
            var[task.get('variable')] =  self.packet.readVarShort()    
        elif task.get('type') == "Int":
            var[task.get('variable')] =  self.packet.readInt() 
        elif task.get('type') == "Short":
            var[task.get('variable')] =  self.packet.readShort()  
        elif task.get('type') == "VarLong":
            var[task.get('variable')] =  self.packet.readVarLong()   
        elif task.get('type') == "Byte":
            var[task.get('variable')] =  self.packet.readByte()  
        elif task.get('type') == "Double":
            var[task.get('variable')] =  self.packet.readDouble()  
        elif task.get('type') == "UTF":
            var[task.get('variable')] =  self.packet.readUTF()  
        elif task.get('type') == "Boolean":
            var[task.get('variable')] =  self.packet.readBoolean()  
        else:
            print("UNKNOWN TYPE ERROR")   
              
        # print(f"VARIABLE : {var}")                                        
        return var    


    def deserialize(self, id):
        
        self.infos = find_dict_by_protocol_id(id)
        # print(f"ID: {id}")
        self.tasks = self.infos.get('attr_write')
        
        self.name = self.infos.get('name')
        self.variables['name'] = self.name
        
        if self.tasks:
            for task in self.tasks:
                # print(len(self.packet.data) - self.packet.pos)
                
                if task.get('variable') and "[" in task.get('variable'):
                    listname = re.sub("\[.*?\]", "", task.get('variable'))
                    length = self.variables[f"{listname}.length"]
                    array = []
                    if task.get('type'):
                        task['variable'] = re.sub("\[.*?\]", "", task.get('variable'))[:-1]
                    for _ in range(length):
                        array.append(self.read(task))
                    self.variables[listname] = array
                else:    
                    self.variables.update(self.read(task))
            


packet = Packet()

datahex = "3c6d060001808080063cd537a282c495e5170008476f726f746f6e6f0201000295199a18000501f4ad6e0285412b0345454504eedbae05abbebf00019b01000014000055c13400050bf7a103a282c495e5170bf7a603a28294b3e4170bf7a603a282c495e5170bf7a803a28294b3e4170bf7a803a282c495e5174e85030000003a950300000029d50600020001007f3fc1ef00130200031b18061e0107047365641b18ab021e01010b0001047314640d000104730f640f000104730d6410000104730c641800041b18181e0107047330641b18aa021e0101047320641a00031b18ac021e01011b18441e0107047317641b000104733f641c000604736d6404731b641b182d1e010704737a641b18a8021e010104732f642400031b187c1e01071b18ad021e0101047387016429000104738601642c000104737105300001047376053c00040473c901640473a9026404739c01640473fc02643e00010473a401053f00010473a801054000010473a601054100010473ab01644a00010473df02057bd561001302010000140b010000140d010000140f01000014100100001418010000141a010000141b010000141c01000014240100001429010000142c0100001430010000143c010000143e010000143f01000014400100001441010000144a0100001400c53e00140100010200010b00010d00010f00011000011800011a00011b00011c00012400012900012c00013000013c00013e00013f00014000014100014a0001851a2fb800c320e701000006fffd41905808100000002084010163be263063969fe09e01ec060004454c49540004454c4954800100ffffff0f0004085b088e81080020e70200fffefff841a62810020000002084010163be2d386396a047a203ec060004454c49540004454c4954800100ffffff0f0004085b20e78208000025ffb041aaa00a0e0000002084010163bdf4f863940d46e2a806f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e70300000900044197b050100000002084010163be49586392273204e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e78308000020ffc041aa9c04220000002084010163bdf4f863940d82abb71cf2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e704000009001241950044140000002084010163be7388639255fa00f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e7050000010008419500043c0000002084010163be1820639a826ad401ec060004454c49540004454c4954800100ffffff0f0004085b20e7850800001dffa841aac816120000002084010163bdf4f863940bdf9e821ef2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e70600000b000f4193a01c040000002084010463bf0e38637fb41dd203f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e70700000a000f4193d038000000002084010163bee40863ac721dd203f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e70800fffa000641990028140000002084010163be9db8636ce743cb068502000341464b001d616c72656164792066696e6973686564206b61726d616661726d696e67d001009f9c5c0800225b8420e70900fffc001441802190100000002084010163bdf4f8634a81f1589706000352444d00074e45555452414cac0300b6000008000b010120e70a00fffefffd4195081c680000002084010163be96b063afcd7700c70400044b4f545300136b696e6773204f6620546865205374726565742f006c6c6908001f1f1e20e70b00ffff002041915048080000002084010163be263063aa71fc8a5bce0800054255434c45001154454d504f524152592050415241444f58ad03002dbbd808003d007720e70c000006001f41950028200000002084010463bdd1d06393699f00830200054375727365000d46616c6c20416e6420526973652200303030080000000020e71600fffd000d41950824280000002084010163bed5f863ab1413e14ca50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e71700fffc001e41942010180000002084010163be9db86362b934a402f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e71b00000c00034195005c500000002084010163be738863656a99fc31a50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e71f00fff8000b41008058000000002084010163be57686380768e00cc070003545247000a5468652d72616e6765730c000000000800ff101120e72000001400184195a054040000002084010163be6c8063abfb276aec060004454c49540004454c4954800100ffffff0f0004085b20e72100fff4fff541a1a008080000002084010163bdaea8634a997fc11ef50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e72b00ffe7ffce41a308201e0000002084010163be4958638430cb02e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e73600fff5ffdc41a3b016020000002084010163be657863ad7eb000cb0200054669656c64000a4669656c6447616d6573890100ffffff210006325020e73700fff1ffc241a2e000000000002084010463bddfe06393b03000830200054375727365000d46616c6c20416e6420526973652200303030080000000020e73800fff9ffd541a2a004020000002084010163bdcac863af501b870da50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e73900ffe9001541a4a01c0a0000002084010163bec7e863b19d39cc8303be0800054c4153504100184c61732050617374696c6c61732044656c20416275656c6f950300627fa1080002313620e73b00ffedffc241a2f008000000002084010163beabc8637b7e2110f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e73d00fff5002341a47018000000002084010163bdcac863bc7dfac80bf408000453616e6700144c27416c6c69616e6365204672616e63616973658601008500000100001b0c20e73e00ffe3fff74197e020000000002084010163bdedf0636f13b499c807f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e74400ffdcffd541a0f0080e0000002084010463beeb10636956308308f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e74500fff3ffd041a29808160000002084010163be495863baecd40ee5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e74600ffe9ffc841a19800000000002084010163beabc863b576a019f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e74700fff1000e41a49012020000002084010163becef06393fd1fe9ee1af2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e74c00ffedffe9416bc120a00000002084010163bdd1d063530d4e00f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e75d000021000c41a2b408100000002084010463bf1540636ea9f6e308f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e76700000d001541950064080000002084010163be9db863ad7dd7bb72910500054b41534841000854616c4b617368618d0300ffd8350800295d6820e7a101000017fffb4197c808140000002084010163be8fa8637fc726e109f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e7a20100001bfff54197c01c040000002084010163beb9d8638217659e30b7010004436f7270000745585452454d45ea0100ff0101090000020020e7a301000014fff4419be030180000002084010163be8fa863b5236d00c70400044b4f545300136b696e6773204f6620546865205374726565742f006c6c6908001f1f1e20e7a401000019fff44197c00c080000002084010163beb2d0639b6802eb131100054c45544845001141736573696e6f7320446520546f646f735000ffffff080000000020e7a50100001d000741a2a800020000002084010163be8fa86399e020a601f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e7a60100001f000a41a2a808080000002084010163bda09863b1c64ddfb302be0800054c4153504100184c61732050617374696c6c61732044656c20416275656c6f950300627fa1080002313620e7a701000021000341a2d818000000002084010463bf548863b226b98d4a820200034b494e000b416c6c204f7572204b696e0f00e08f15080023232320e7a80100fff5fff341a1a00c040000002084010163bed5f8639c92b7f5a201a50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e7a90100fff3fff941a1a004100000002084010163bda7a0637404158409f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7aa01000004001e4197b020180000002084010163bec7e863b19c7ad5b801be0800054c4153504100184c61732050617374696c6c61732044656c20416275656c6f950300627fa1080002313620e7b20100fffcffdb419e100c200000002084010163be111863a0f9399b06f50600044d5954480010507265736167696f2044656c2046696eb50300f5c540010000000020e7b30100000d000541950064480000002084010163bea4c063947b84d301ec060004454c49540004454c4954800100ffffff0f0004085b20e7b401000005fffa41905810040000002084010163be495863921e4500e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e7b501000008fffa419840485c0000002084010163bed5f863ab146af68102a50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e7b60100fff1000341918008080000002084010163be2d386397f75d00ec060004454c49540004454c4954800100ffffff0f0004085b20e7d10100ffd6ffef4102a888000000002084010163bda0986345addcaa0df50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7e60100fff5000d41838000000000002084010163be495863956dfda2f602910500054b41534841000854616c4b617368618d0300ffd8350800295d6820e7e70100fff3fffb4192003c080000002084010163be344063b25d4ffb50ce0800054255434c45001154454d504f524152592050415241444f58ad03002dbbd808003d007720e7e80100fffafffd41006818000000002084010163bdaea86362a210d0cc07f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7e90100fff600024100a010000000002084010163be3b4863940f2a00830200054375727365000d46616c6c20416e6420526973652200303030080000000020e7ea0100fff8001241918040440000002084010163be495863a11d7408e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e7eb0100ffea000641918830140000002084010163be0308639134a4de07ec060004454c49540004454c4954800100ffffff0f0004085b20e7fd0100fff100084181c060180000002084010163bdedf06396b2108ca901e10700054d4945444f001254686520556e696f6e205370617274616e61050020dda4010000000020e7930200ffee000e418e6000000000002084010763bf0e38635db654ebb601f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7940200fffb000341990018040000002084010163bdf4f863755402810ff50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7950200fffd000b41990038040000002084010163bec0e06360e6c1c1f002cb01000358656c000758656c6f72656ea50100e9b6530800296faa20e7970200ffe9ffc041a30828020000002084010163bea4c063971aa200b7010004436f7270000745585452454d45ea0100ff0101090000020020e7980200ffe8001e41a48820020000002084010463bea4c0637f6df1e412f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7ba0200fffc001841a7a008000000002084010163be8fa863a82b97951cf50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7bb0200fffd001a41942018080000002084010163be7a90636667a7de7bf50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7bc0200fffd001941a7d808000000002084010163be495863831e6010e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f00000000088ebf020020e7ce0200ffe3fff64197e024040000002084010763bf23506376e6f1a742f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7c50300ffccfffe41034810000000002084010163bda7a0636fb4a5bd06f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7c60300ffd0001341030098000000002084010163bdaea8636faf9d9310f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7c70300ffcb0014418e8030000000002084010163bdc3c063940027fdd701f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7c90300ffc9fffb41037828000000002084010163be81986345a85300f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e7cd0300ffc9fffc4175a030300000002084010163be0a1063a05a37a809f50600044d5954480010507265736167696f2044656c2046696eb50300f5c540010000000020e7d00300ffca001141770020b00000002084010763bf07306393fed4d1f901f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7d10300ffcb000541035028000000002084010163bdbcb863b08ef000f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7d20300ffd200114102e088000000002084010163bec0e06362a69f00cb01000358656c000758656c6f72656ea50100e9b6530800296faa20e7d40300ffcb000f417ac040000000002084010163bda7a063575f13a5e716f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7d50300ffca000f417ac020000000002084010163beb9d863940c9289fa12f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7d70300ffc2fff64103e850000000002084010163be8fa86391c13a8709ec060004454c49540004454c4954800100ffffff0f0004085b20e7d80300ffca0010417880e0000000002084010163bdb5b06393f747baf901f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7df030000080000419050081c0000002084010163be182063b23fb7b107b6010004486f6d650006416c776179733d00f9ddd208004a627420e7e00300fffd000a41950824340000002084010163be495863a1174f33e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e7e10300000a000a4195004c340000002084010463bf316063acbc6ecb03f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7e20300ffff00054197b020300000002084010163be49586392298504e5070005474c4f434b000d4c4f532d494c554d494e415449ec0100e69b0c1f0000000020e7e50300000800024195003c540000002084010163be111863968a9aff02ec060004454c49540004454c4954800100ffffff0f0004085b20e7ea03000005001a419500200c0000002084010163be344063b4be359208b6010004486f6d650006416c776179733d00f9ddd208004a627420e7ec0300fffd000c41a5b010020000002084010163be2630638424fcb80ff50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7ef0300fff7001d41a59828000000002084010163bedd006379aee2a8be0ff2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7850400fff5001c41a498200c0000002084010763bf2a58639341bffbb502f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7860400ffffffd3419e80283c0000002084010163be263063b2492aa745b6010004486f6d650006416c776179733d00f9ddd208004a627420e7870400fffbffca419e1004640000002084010163beb9d863940b2b87d917f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7890400fff1ffd941a0a0180c0000002084010163be425063b11718b9ec03be0800054c4153504100184c61732050617374696c6c61732044656c20416275656c6f950300627fa1080002313620e78a0400ffe4fff541a47800000000002084010163be182063af9e708fdf01a50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e78b0400fff6ffd4419fc020080000002084010163be4958636b3aef849f03a50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e78d0400ffeaffe841a39c08180000002084010163bdd1d063a4cb43d011f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e78e0400ffe3000541a48408160000002084010163be0a10637ff074e809f50100054165676973000e4b696e6472656420486561727468d40100ffffff100035032720e7d80400ffacffd84189d549400000002084010163be1820638f45ea9da901e10700054d4945444f001254686520556e696f6e205370617274616e61050020dda4010000000020e7d90400ffabffd44189d559600000002084010163be263063981599f3e903910500054b41534841000854616c4b617368618d0300ffd8350800295d6820e7da0400ffbcffde4189d449100000002084010163bddfe063549903e1dd0ff2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7db0400ffb2ffb94189d4ea380000002084010163beb9d8639400e3cba319f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7dc0400ffc0ffcc4189d409a00000002084010163bda0986356068ceca10bf2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7dd0400ffb7ffbb418ca0b0200000002084010163bde6e86354c3198cc50ff2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7de0400ffb0ffb54189d50a580000002084010163bdd8d86356e081f2cf0ef2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7e00400ffc3ffbb4189d3da280000002084010163bde6e86355731c88b310f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7e10400ffc4ffac4189d3caa00000002084010163bdcac86361dddae0e50cf2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7e20400ffb9ffad4189d47a980000002084010163bdcac86360a1d5cec90ef2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7e30400ffc1ffb54189d3fa580000002084010163bdd8d8635fe4a2a8b610f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7e70400ffc0ffc9418aa000000000002084010163bda09863549319eca10bf2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7ee0400ffb4ffb5418c6080000000002084010163bec7e863761b35efcf0ef2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e78b0500ffc9ffd74189d379480000002084010163bd999063607f0d9fb610f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e78c0500ffccffd34189d349680000002084010163bd9990635498e799b610f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7f10500ffc1ffb5418da030400000002084010163bec0e063736b8c89b610f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7910600ffc3ffb64199f04c180000002084010163beb2d063940b8cc3b810f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7920600ffcbffac4199f034780000002084010163bec0e063940bbdb6b810f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7930600ffc1ffaa4199f84c540000002084010163beb2d063940b2ac0b810f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7940600ffbaffaf4199f864180000002084010163bec0e063940b2ac1b810f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7950600ffc3ffb1419ad004400000002084010163bdbcb863549ff3e09f12f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e79e0600001cfff3419b9008240000002084010163bdc3c06369d844cec714f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e79f060000150007419c2004040000002084010163be88a0636e61bf00f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e7a4060000160013419c10180c0000002084010163be0308638dc7e6d79f12f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7a5060000160013419c1018440000002084010163bdfc006393fb2cbaa311f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7a6060000150012419c10403c0000002084010163bdfc006393fa86c7a311f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7a80600ffef000841999050000000002084010163be6578639ec1bef4bd0cbe0800054c4153504100184c61732050617374696c6c61732044656c20416275656c6f950300627fa1080002313620e7a90600fffeffcb419e101c600000002084010163bdb5b06354ae01f28313f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7ad06000006000d419d0010080000002084010163be7a906345adc700f004000346494e001054686520456e64204f662054696d6573930100e7a2041c00266eee20e7b00600ffe2fff6419d70080c0000002084010163be96b063b6b30f00cc060004534c445300084169736c61646f73810100ffffff1a0002000020e7b10600001dfff4419d90080c0000002084010163bdb5b0636f2823fbb601f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7b40600fffdffff419ed0100c0000002084010163be88a063a7479e00c70400044b4f545300136b696e6773204f6620546865205374726565742f006c6c6908001f1f1e20e7b506000000fffd419ec000100000002084010163be1f286397bd6367a407000554554d424100134772616e2054756d6261204e617a617269636bea0100ffffff010000000020e7b60600fff9fffc419ef030080000002084010163bdfc0063967746c6d71ef2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7ba0600fffcfffc419ed008000000002084010163be03086393fd22c6a411f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7bb06000005000241a06018000000002084010163be5e706346c8bd00f104000357414c000e576520417265204c6567656e6473b50300ffffff0c0000000020e7bc06000006000541a06018040000002084010163beb2d06394018fe5ed1af2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7bd06000008fffc41a0381a140000002084010163beb2d06393ff38c1a311f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7c106000001000541a08800000000002084010163beb2d06393fe86d7a311f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7c20600ffacffc541a0c002020000002084010163bd999063608936e49f12f2040003424153000a4c6520426173696c69633a00ffdd550f0026000120e7c406000001000641a14c10000000002084010163be1820637a6227eb7aa407000554554d424100134772616e2054756d6261204e617a617269636bea0100ffffff010000000020e7c506000001000141a14410000000002084010163be2630637a6d7ed6b201a407000554554d424100134772616e2054756d6261204e617a617269636bea0100ffffff010000000020e7c606000001fffc41a13c10000000002084010163be2d38637a72bbabdf01a407000554554d424100134772616e2054756d6261204e617a617269636bea0100ffffff010000000020e7d206000026ffec41a37008000000002084010163be88a06345da6c0081030003455241000c4d6572696469616e20457261890300d9d2f1080022193720e7d706000001fffb41a338100c0000002084010163be5768637c6cfd8014a50700034345540010436f6e666c6963746f20457465726e6f0700ffffff11000e294220e7d806000001000141a33004020000002084010163be0a106382859ac11eb6010004486f6d650006416c776179733d00f9ddd208004a627420e7d90600fff5ffee41a3401a040000002084010163be3b48638ad7a9008c0800035452500010746865207265616c2070656e686974655a00808080080000000020e7dc06000018001b41a42810040000002084010163bdaea8635878bda99e12f2040003424153000a4c"
packet.addData(bytearray.fromhex(datahex))


while len(packet.data) > 0:
    print("Nouveau packet ------------------------------------------------------------")
    packet.readHiHeader()
    length = packet.readLength()
    msg = Message(packet)

    msg.deserialize(packet.packet_id)   
    msg.packet.end()     

    print(msg.variables)
